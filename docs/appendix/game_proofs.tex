% !TeX root = ../main.tex
\chapter{Game-based Proofs}\label{appendix:security}

\section{Evaluation Binding Proof}
\begin{equation*}
    \begin{aligned}
        \text{eval\_bind\_game}&=\left(
        \begin{aligned}
            PK & \leftarrow \text{key\_gen}, \\
            (C, i,\phi_i,\omega_i, \phi_i',\omega_i') & \leftarrow \mathcal{A} \ PK, \\
            \_::\text{unit} & \leftarrow \text{assert\_spmf}(\phi_i \ne \phi_i' \\
            &\land \text{valid\_msg}\ \phi_i\ \omega_i \land \text{valid\_msg}\ \phi_i'\ \omega_i'), \\
            b &= \text{VerifyEval } PK\ C\ i\ \phi_i\ \omega_i,\\
            b' &= \text{VerifyEval } PK\ C\ i\ \phi_i'\ \omega_i',\\
            & : \ b \land b'
        \end{aligned}
        \right)\\
        &= \left(
            \begin{aligned}
                PK & \leftarrow \text{key\_gen}, \\
                (C, i,\phi_i,\omega_i, \phi_i',\omega_i') & \leftarrow \mathcal{A} \ PK, \\
                \_::\text{unit} & \leftarrow \text{assert\_spmf}(\phi_i \ne \phi_i' \\
                &\land \text{valid\_msg}\ \phi_i\ \omega_i \land \text{valid\_msg}\ \phi_i'\ \omega_i' \\
                &\land \text{VerifyEval } PK\ C\ i\ \phi_i\ \omega_i\\
                &\land \text{VerifyEval } PK\ C\ i\ \phi_i'\ \omega_i'),\\
                & : True
            \end{aligned}
            \right)\\
        &\le \left(
            \begin{aligned}
                a & \leftarrow \mathbb{F}_p, \\
                b & \leftarrow \mathcal{A}, \\
                c & = F(a,b) \\
                & : \ P(c)
            \end{aligned}
            \right)
    \end{aligned}
\end{equation*}

\section{Hiding Proof}
\label{appendix:security:hiding}

\subsection*{PickDistinct Algorithm}
\label{appendix:security:hiding:picki}

\section{Knowledge Soundness Proof}
\label{appendix:security:knowledgesound}